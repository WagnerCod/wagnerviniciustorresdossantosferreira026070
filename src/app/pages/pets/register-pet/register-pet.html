<div class="register-pet-container">
  <mat-card class="form-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>pets</mat-icon>
        Cadastrar Novo Pet
      </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="petForm" (ngSubmit)="onSubmit()" class="pet-form">
        
        <!-- Upload de Foto -->
        <div class="photo-section">
          <div class="photo-preview" [class.has-image]="imagePreview">
            @if (imagePreview) {
              <img [src]="imagePreview" alt="Preview da foto do pet">
              <button 
                type="button" 
                mat-mini-fab 
                color="warn" 
                class="remove-photo-btn"
                (click)="removeImage()"
                aria-label="Remover foto">
                <mat-icon>close</mat-icon>
              </button>
            } @else {
              <mat-icon class="placeholder-icon">add_photo_alternate</mat-icon>
              <p>Clique para adicionar foto</p>
            }
          </div>
          
          <input 
            type="file" 
            accept="image/*" 
            #fileInput 
            (change)="onFileSelected($event)"
            style="display: none">
          
          <button 
            type="button" 
            mat-raised-button 
            color="primary"
            (click)="fileInput.click()"
            [disabled]="loading">
            <mat-icon>upload</mat-icon>
            Selecionar Foto
          </button>
          <p class="hint">Formatos aceitos: JPG, PNG (máx. 5MB)</p>
        </div>

        <!-- Campo Nome -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Nome do Pet</mat-label>
          <input 
            matInput 
            formControlName="nome" 
            placeholder="Ex: Rex"
            [disabled]="loading">
          <mat-icon matPrefix>badge</mat-icon>
          @if (petForm.get('nome')?.invalid && petForm.get('nome')?.touched) {
            <mat-error>{{ getErrorMessage('nome') }}</mat-error>
          }
        </mat-form-field>

        <!-- Campo Raça -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Raça</mat-label>
          <input 
            matInput 
            formControlName="raca" 
            placeholder="Ex: Labrador"
            [disabled]="loading">
          <mat-icon matPrefix>category</mat-icon>
          @if (petForm.get('raca')?.invalid && petForm.get('raca')?.touched) {
            <mat-error>{{ getErrorMessage('raca') }}</mat-error>
          }
        </mat-form-field>

        <!-- Campo Idade -->
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Idade</mat-label>
          <input 
            matInput 
            type="number" 
            formControlName="idade" 
            placeholder="Ex: 3"
            min="0"
            max="50"
            [disabled]="loading">
          <mat-icon matPrefix>cake</mat-icon>
          <span matSuffix>anos</span>
          @if (petForm.get('idade')?.invalid && petForm.get('idade')?.touched) {
            <mat-error>{{ getErrorMessage('idade') }}</mat-error>
          }
        </mat-form-field>

        <!-- Botões de Ação -->
        <div class="form-actions">
          <button 
            type="button" 
            mat-stroked-button 
            (click)="onCancel()"
            [disabled]="loading">
            <mat-icon>close</mat-icon>
            Cancelar
          </button>
          
          <button 
            type="submit" 
            mat-raised-button 
            color="primary"
            [disabled]="loading || petForm.invalid">
            @if (loading) {
              <mat-spinner diameter="20" class="spinner-button"></mat-spinner>
            } @else {
              <mat-icon>save</mat-icon>
            }
            {{ loading ? 'Salvando...' : 'Cadastrar Pet' }}
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
